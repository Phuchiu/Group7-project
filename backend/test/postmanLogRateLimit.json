{
  "info": {
    "name": "Activity Log & Rate Limit API Tests",
    "description": "Test collection for Activity Logging and Rate Limiting functionality",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Login User (Normal)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"user123\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        },
        "description": "Should log successful login activity"
      }
    },
    {
      "name": "2. Failed Login Attempt 1",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"wrongpassword\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        },
        "description": "Should log failed login attempt"
      }
    },
    {
      "name": "3. Failed Login Attempt 2",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"wrongpassword\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        }
      }
    },
    {
      "name": "4. Failed Login Attempt 3",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"wrongpassword\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        }
      }
    },
    {
      "name": "5. Failed Login Attempt 4",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"wrongpassword\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        }
      }
    },
    {
      "name": "6. Failed Login Attempt 5 (Should be Rate Limited)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"wrongpassword\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "login"]
        },
        "description": "Should return rate limit error"
      }
    },
    {
      "name": "7. Get User Activity Logs (Admin)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{adminToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/api/admin/logs/user/{{userId}}",
          "host": ["http://localhost:3000"],
          "path": ["api", "admin", "logs", "user", "{{userId}}"]
        },
        "description": "Get activity logs for specific user"
      }
    },
    {
      "name": "8. Get All Activity Logs (Admin)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{adminToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/api/admin/logs?limit=50&skip=0",
          "host": ["http://localhost:3000"],
          "path": ["api", "admin", "logs"],
          "query": [
            {
              "key": "limit",
              "value": "50"
            },
            {
              "key": "skip",
              "value": "0"
            }
          ]
        },
        "description": "Get all activity logs with pagination"
      }
    },
    {
      "name": "9. Get Failed Login Logs (Admin)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{adminToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/api/admin/logs/action/failed_login",
          "host": ["http://localhost:3000"],
          "path": ["api", "admin", "logs", "action", "failed_login"]
        },
        "description": "Get all failed login attempts"
      }
    },
    {
      "name": "10. Get Activity Statistics (Admin)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{adminToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/api/admin/logs/stats?hours=24",
          "host": ["http://localhost:3000"],
          "path": ["api", "admin", "logs", "stats"],
          "query": [
            {
              "key": "hours",
              "value": "24"
            }
          ]
        },
        "description": "Get activity statistics for last 24 hours"
      }
    },
    {
      "name": "11. Update Profile (Should Log Activity)",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{userToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Updated Name\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/profile",
          "host": ["http://localhost:3000"],
          "path": ["api", "profile"]
        },
        "description": "Should log profile_update activity"
      }
    },
    {
      "name": "12. Logout (Should Log Activity)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{userToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/api/auth/logout",
          "host": ["http://localhost:3000"],
          "path": ["api", "auth", "logout"]
        },
        "description": "Should log logout activity"
      }
    }
  ],
  "variable": [
    {
      "key": "userToken",
      "value": ""
    },
    {
      "key": "adminToken",
      "value": ""
    },
    {
      "key": "userId",
      "value": ""
    }
  ]
}